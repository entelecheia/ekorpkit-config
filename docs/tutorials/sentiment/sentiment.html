
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LM Dictionary vs. finbert vs. T5 &#8212; eKorpkit Tutorials</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet">
  <link href="../../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script >let toggleHintShow = 'Click to show';</script>
    <script >let toggleHintHide = 'Click to hide';</script>
    <script >let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script >const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Preprocessors" href="../preprocessors/preprocessor.html" />
    <link rel="prev" title="Prediciting Sentiments" href="predict_edgar.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/ekorpkit.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">eKorpkit Tutorials</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../intro.html">
   ekorpkit[iːkɔːkɪt]: English Korean Corpus Toolkit
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  About
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../about/about.html">
   Getting started
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../about/install.html">
     Installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../about/usage.html">
     Usage
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../config/config.html">
   Compose an ekorpkit config
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   Sentiment Analysis
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="lexicon.html">
     Sentiment Lexicons
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lbsa_en.html">
     Lexicon-based Sentiment Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="predict_edgar.html">
     Prediciting Sentiments
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     LM Dictionary vs. finbert vs. T5
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../preprocessors/preprocessor.html">
   Preprocessors
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../preprocessors/mecab.html">
     Mecab Tokenizer
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Datasets
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../corpus/ekorpkot_corpus.html">
   The eKorpkit Corpus
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Use cases
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../usecases/esg_topics/analyst.html">
   ESG Topic Analysis
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/docs/tutorials/sentiment/sentiment.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/entelecheia/ekorpkit-config"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/entelecheia/ekorpkit-config/issues/new?title=Issue%20on%20page%20%2Fdocs/tutorials/sentiment/sentiment.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/entelecheia/ekorpkit-config/main?urlpath=tree/ekorpkit-book/docs/tutorials/sentiment/sentiment.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prepare-financial-phrasebank-dataset">
   Prepare
   <code class="docutils literal notranslate">
    <span class="pre">
     financial_phrasebank
    </span>
   </code>
   dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#compose-a-config-for-the-lm-sentiment-analyser-class">
   Compose a config for the LM sentiment analyser class
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#instantiating-a-sentiment-analyser-class-with-financial-phrasebank-dataset">
   Instantiating a sentiment analyser class with
   <code class="docutils literal notranslate">
    <span class="pre">
     financial_phrasebank
    </span>
   </code>
   dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#instantiating-a-transformer-classficiation-model-with-financial-phrasebank-dataset">
   Instantiating a transformer classficiation model with
   <code class="docutils literal notranslate">
    <span class="pre">
     financial_phrasebank
    </span>
   </code>
   dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#instantiating-a-t5-classficiation-model-with-financial-phrasebank-dataset">
   Instantiating a T5 classficiation model with
   <code class="docutils literal notranslate">
    <span class="pre">
     financial_phrasebank
    </span>
   </code>
   dataset
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>LM Dictionary vs. finbert vs. T5</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prepare-financial-phrasebank-dataset">
   Prepare
   <code class="docutils literal notranslate">
    <span class="pre">
     financial_phrasebank
    </span>
   </code>
   dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#compose-a-config-for-the-lm-sentiment-analyser-class">
   Compose a config for the LM sentiment analyser class
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#instantiating-a-sentiment-analyser-class-with-financial-phrasebank-dataset">
   Instantiating a sentiment analyser class with
   <code class="docutils literal notranslate">
    <span class="pre">
     financial_phrasebank
    </span>
   </code>
   dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#instantiating-a-transformer-classficiation-model-with-financial-phrasebank-dataset">
   Instantiating a transformer classficiation model with
   <code class="docutils literal notranslate">
    <span class="pre">
     financial_phrasebank
    </span>
   </code>
   dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#instantiating-a-t5-classficiation-model-with-financial-phrasebank-dataset">
   Instantiating a T5 classficiation model with
   <code class="docutils literal notranslate">
    <span class="pre">
     financial_phrasebank
    </span>
   </code>
   dataset
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="lm-dictionary-vs-finbert-vs-t5">
<h1>LM Dictionary vs. finbert vs. T5<a class="headerlink" href="#lm-dictionary-vs-finbert-vs-t5" title="Permalink to this headline">¶</a></h1>
<p><a href="https://colab.research.google.com/github/entelecheia/ekorpkit-config/blob/main/notebooks/sentiment/financial_phrasebank_t5.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %%capture</span>
<span class="c1"># %pip install ekorpkit[model,tokenize,dataset]==0.1.27</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="prepare-financial-phrasebank-dataset">
<h2>Prepare <code class="docutils literal notranslate"><span class="pre">financial_phrasebank</span></code> dataset<a class="headerlink" href="#prepare-financial-phrasebank-dataset" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ekorpkit</span> <span class="kn">import</span> <span class="n">eKonf</span>

<span class="n">ds_cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">config_group</span><span class="o">=</span><span class="s1">&#39;dataset=dataset&#39;</span><span class="p">)</span>
<span class="n">ds_cfg</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;financial_phrasebank&#39;</span>
<span class="n">ds_cfg</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="s2">&quot;${cached_path:&#39;https://github.com/entelecheia/ekorpkit-config/raw/main/data/financial_phrasebank.zip&#39;,true,false}&quot;</span>
<span class="n">ds_cfg</span><span class="o">.</span><span class="n">use_name_as_subdir</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">ds_cfg</span><span class="p">)</span>
<span class="n">ds</span><span class="o">.</span><span class="n">info</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;name&#39;: &#39;financial_phrasebank&#39;,
 &#39;domain&#39;: &#39;econ&#39;,
 &#39;task&#39;: &#39;classification&#39;,
 &#39;lang&#39;: &#39;en&#39;,
 &#39;column_info&#39;: {&#39;keys&#39;: {&#39;id&#39;: &#39;id&#39;, &#39;text&#39;: &#39;text&#39;},
  &#39;data&#39;: {&#39;id&#39;: &#39;int&#39;, &#39;labels&#39;: &#39;str&#39;, &#39;text&#39;: &#39;str&#39;}},
 &#39;splits&#39;: {&#39;train&#39;: {&#39;name&#39;: &#39;train&#39;,
   &#39;dataset_name&#39;: &#39;financial_phrasebank&#39;,
   &#39;data_file&#39;: &#39;financial_phrasebank-train.csv&#39;,
   &#39;num_examples&#39;: 1445,
   &#39;num_bytes&#39;: 176485,
   &#39;num_bytes_median&#39;: 112.0,
   &#39;num_bytes_max&#39;: 315,
   &#39;num_bytes_min&#39;: 15,
   &#39;human_bytes&#39;: &#39;172.35 KiB&#39;},
  &#39;test&#39;: {&#39;name&#39;: &#39;test&#39;,
   &#39;dataset_name&#39;: &#39;financial_phrasebank&#39;,
   &#39;data_file&#39;: &#39;financial_phrasebank-test.csv&#39;,
   &#39;num_examples&#39;: 452,
   &#39;num_bytes&#39;: 55518,
   &#39;num_bytes_median&#39;: 110.0,
   &#39;num_bytes_max&#39;: 296,
   &#39;num_bytes_min&#39;: 11,
   &#39;human_bytes&#39;: &#39;54.22 KiB&#39;},
  &#39;dev&#39;: {&#39;name&#39;: &#39;dev&#39;,
   &#39;dataset_name&#39;: &#39;financial_phrasebank&#39;,
   &#39;data_file&#39;: &#39;financial_phrasebank-dev.csv&#39;,
   &#39;num_examples&#39;: 362,
   &#39;num_bytes&#39;: 43404,
   &#39;num_bytes_median&#39;: 109.0,
   &#39;num_bytes_max&#39;: 296,
   &#39;num_bytes_min&#39;: 9,
   &#39;human_bytes&#39;: &#39;42.39 KiB&#39;}},
 &#39;num_examples&#39;: 2259,
 &#39;size_in_bytes&#39;: 275407,
 &#39;size_in_human_bytes&#39;: &#39;268.95 KiB&#39;,
 &#39;data_files&#39;: {&#39;train&#39;: &#39;financial_phrasebank-train.csv&#39;,
  &#39;test&#39;: &#39;financial_phrasebank-test.csv&#39;,
  &#39;dev&#39;: &#39;financial_phrasebank-dev.csv&#39;},
 &#39;meta_files&#39;: {},
 &#39;data_files_modified&#39;: &#39;2022-04-22 03:18:20&#39;,
 &#39;info_updated&#39;: &#39;2022-04-22 03:18:20&#39;}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="compose-a-config-for-the-lm-sentiment-analyser-class">
<h2>Compose a config for the LM sentiment analyser class<a class="headerlink" href="#compose-a-config-for-the-lm-sentiment-analyser-class" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ekorpkit</span> <span class="kn">import</span> <span class="n">eKonf</span>

<span class="n">config_group</span><span class="o">=</span><span class="s1">&#39;model/sentiment=lm&#39;</span>
<span class="n">model_cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">config_group</span><span class="o">=</span><span class="n">config_group</span><span class="p">)</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">preprocessor</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">nltk</span><span class="o">.</span><span class="n">lemmatize</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="instantiating-a-sentiment-analyser-class-with-financial-phrasebank-dataset">
<h2>Instantiating a sentiment analyser class with <code class="docutils literal notranslate"><span class="pre">financial_phrasebank</span></code> dataset<a class="headerlink" href="#instantiating-a-sentiment-analyser-class-with-financial-phrasebank-dataset" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">config_group</span><span class="o">=</span><span class="s1">&#39;pipeline=pipeline&#39;</span><span class="p">)</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">ds_cfg</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">_pipeline_</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;predict&#39;</span><span class="p">]</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">predict</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model_cfg</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">predict</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">=</span> <span class="s2">&quot;./data/predict&quot;</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">predict</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ds_cfg</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">.parquet&#39;</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;autoload&#39;: True,
 &#39;column_info&#39;: {&#39;data&#39;: {&#39;id&#39;: &#39;int&#39;, &#39;labels&#39;: &#39;str&#39;, &#39;text&#39;: &#39;str&#39;},
                 &#39;keys&#39;: {&#39;id&#39;: &#39;id&#39;, &#39;text&#39;: &#39;text&#39;}},
 &#39;data_dir&#39;: &#39;/root/.ekorpkit/.cache/cached_path/49a839699a03cebce770185da2650f8f9617b2a6b123483c9dd844fc72152cbf.93114266beb1264222949b1d3eb5704095408b3d0edee605c8ff6ece6921f321-extracted&#39;,
 &#39;data_files&#39;: {&#39;dev&#39;: &#39;financial_phrasebank-dev.csv&#39;,
                &#39;test&#39;: &#39;financial_phrasebank-test.csv&#39;,
                &#39;train&#39;: &#39;financial_phrasebank-train.csv&#39;},
 &#39;data_files_modified&#39;: &#39;2022-04-22 03:18:20&#39;,
 &#39;domain&#39;: &#39;econ&#39;,
 &#39;filetype&#39;: &#39;csv&#39;,
 &#39;info_updated&#39;: &#39;2022-04-22 03:18:20&#39;,
 &#39;lang&#39;: &#39;en&#39;,
 &#39;meta_files&#39;: {},
 &#39;name&#39;: &#39;financial_phrasebank&#39;,
 &#39;num_examples&#39;: 2259,
 &#39;size_in_bytes&#39;: 275407,
 &#39;size_in_human_bytes&#39;: &#39;268.95 KiB&#39;,
 &#39;splits&#39;: {&#39;dev&#39;: {&#39;data_file&#39;: &#39;financial_phrasebank-dev.csv&#39;,
                    &#39;dataset_name&#39;: &#39;financial_phrasebank&#39;,
                    &#39;human_bytes&#39;: &#39;42.39 KiB&#39;,
                    &#39;name&#39;: &#39;dev&#39;,
                    &#39;num_bytes&#39;: 43404,
                    &#39;num_bytes_max&#39;: 296,
                    &#39;num_bytes_median&#39;: 109.0,
                    &#39;num_bytes_min&#39;: 9,
                    &#39;num_examples&#39;: 362},
            &#39;test&#39;: {&#39;data_file&#39;: &#39;financial_phrasebank-test.csv&#39;,
                     &#39;dataset_name&#39;: &#39;financial_phrasebank&#39;,
                     &#39;human_bytes&#39;: &#39;54.22 KiB&#39;,
                     &#39;name&#39;: &#39;test&#39;,
                     &#39;num_bytes&#39;: 55518,
                     &#39;num_bytes_max&#39;: 296,
                     &#39;num_bytes_median&#39;: 110.0,
                     &#39;num_bytes_min&#39;: 11,
                     &#39;num_examples&#39;: 452},
            &#39;train&#39;: {&#39;data_file&#39;: &#39;financial_phrasebank-train.csv&#39;,
                      &#39;dataset_name&#39;: &#39;financial_phrasebank&#39;,
                      &#39;human_bytes&#39;: &#39;172.35 KiB&#39;,
                      &#39;name&#39;: &#39;train&#39;,
                      &#39;num_bytes&#39;: 176485,
                      &#39;num_bytes_max&#39;: 315,
                      &#39;num_bytes_median&#39;: 112.0,
                      &#39;num_bytes_min&#39;: 15,
                      &#39;num_examples&#39;: 1445}},
 &#39;task&#39;: &#39;classification&#39;,
 &#39;use_name_as_subdir&#39;: True,
 &#39;verbose&#39;: True}
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "1844866c30fc4556a40ba1f4d8651f51"}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> &gt;&gt; saved dataframe to ./data/predict/financial_phrasebank-train.parquet
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "b05b937591a845af910f837d6ffe5c21"}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> &gt;&gt; saved dataframe to ./data/predict/financial_phrasebank-test.parquet
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "b81db86e8c714702bbb8388521793238"}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> &gt;&gt; saved dataframe to ./data/predict/financial_phrasebank-dev.parquet
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;train&#39;:         id    labels                                               text  \
 0      655   neutral  Customers in a wide range of industries use ou...   
 1      634   neutral  The writing and publication of Lemmink+ñinen -...   
 2     1030   neutral  Sullivan said some of the boards `` really inv...   
 3      317  positive  The six breweries recorded a 5.2 percent growt...   
 4      868  positive  In the second quarter of 2010 , the company &#39;s...   
 ...    ...       ...                                                ...   
 1440   136  positive  In the fourth quarter of 2009 , Orion &#39;s net p...   
 1441  2170  negative  Profit for the period totalled EUR 1.1 mn , do...   
 1442   344  positive  The diluted loss per share narrowed to EUR 0.2...   
 1443   573   neutral  LKAB , headquartered in Lulea , Sweden , is a ...   
 1444  1768   neutral  The EBRD is using its own funds to provide a 2...   
 
       split  polarity  subjectivity polarity_label  uncertainty  
 0     train  0.000000      0.000000        neutral          0.0  
 1     train  0.999999      0.045455       positive          0.0  
 2     train  0.000000      0.000000        neutral          0.0  
 3     train  0.000000      0.000000        neutral          0.0  
 4     train -0.999999      0.034483       negative          0.0  
 ...     ...       ...           ...            ...          ...  
 1440  train  0.000000      0.000000        neutral          0.0  
 1441  train  0.000000      0.000000        neutral          0.0  
 1442  train -0.999999      0.076923       negative          0.0  
 1443  train  0.000000      0.000000        neutral          0.0  
 1444  train  0.000000      0.000000        neutral          0.0  
 
 [1445 rows x 8 columns],
 &#39;test&#39;:        id    labels                                               text split  \
 0     505   neutral  Los Angeles-based Pacific Office Properties Tr...  test   
 1     783  positive  Investors will continue being interested in th...  test   
 2    2253  negative  Repeats sees 2008 operating profit down y-y ( ...  test   
 3    1374   neutral  The acquisition was financed with $ 2.56 billi...  test   
 4     243  positive  Profit per share was EUR 1.03 , up from EUR 0....  test   
 ..    ...       ...                                                ...   ...   
 447   605   neutral  The commission said the hydrogen peroxide and ...  test   
 448  2258  negative  Sales in Finland decreased by 2.0 % , and inte...  test   
 449   254  positive  The earnings per share for the quarter came in...  test   
 450  1390   neutral  The company can not give up palm oil altogethe...  test   
 451   181  positive  Pretax profit rose to EUR 1,019 mn from EUR 1,...  test   
 
      polarity  subjectivity polarity_label  uncertainty  
 0         0.0           0.0        neutral          0.0  
 1         0.0           0.0        neutral          0.0  
 2         0.0           0.0        neutral          0.0  
 3         0.0           0.0        neutral          0.0  
 4         0.0           0.0        neutral          0.0  
 ..        ...           ...            ...          ...  
 447       0.0           0.0        neutral          0.0  
 448       0.0           0.0        neutral          0.0  
 449       0.0           0.0        neutral          0.0  
 450       0.0           0.0        neutral          0.0  
 451       0.0           0.0        neutral          0.0  
 
 [452 rows x 8 columns],
 &#39;dev&#39;:        id    labels                                               text split  \
 0    1449   neutral       The identity of the buyer is not yet known .   dev   
 1     165  positive  Operating profit rose to EUR 3.2 mn from EUR 1...   dev   
 2    1334   neutral  Previously , Grimaldi held a 46.43 pct stake i...   dev   
 3     907   neutral  A total of $ 78 million will be invested in th...   dev   
 4    1371   neutral  The 19,200-square metre technology center is l...   dev   
 ..    ...       ...                                                ...   ...   
 357  1120   neutral  Under a preliminary estimation , the technolog...   dev   
 358   404  positive  Operating profit improved by 27 % to EUR 579.8...   dev   
 359  1708   neutral  Rohwedder Group is an automotive supplies , te...   dev   
 360   225  positive  In January-September 2007 , the group &#39;s net s...   dev   
 361  1008   neutral  Payment of shares shall be effected on subscri...   dev   
 
      polarity  subjectivity polarity_label  uncertainty  
 0    0.000000      0.000000        neutral     0.000000  
 1    0.000000      0.000000        neutral     0.000000  
 2    0.000000      0.000000        neutral     0.000000  
 3    0.000000      0.000000        neutral     0.000000  
 4    0.000000      0.000000        neutral     0.000000  
 ..        ...           ...            ...          ...  
 357  0.000000      0.000000        neutral     0.066667  
 358  0.999999      0.058824       positive     0.000000  
 359  0.000000      0.000000        neutral     0.000000  
 360  0.000000      0.000000        neutral     0.000000  
 361  0.000000      0.000000        neutral     0.000000  
 
 [362 rows x 8 columns]}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">predict</span><span class="o">.</span><span class="n">output_dir</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">predict</span><span class="o">.</span><span class="n">output_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./data/predict
financial_phrasebank.parquet
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eval_cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">config_group</span><span class="o">=</span><span class="s1">&#39;model/eval=classification&#39;</span><span class="p">)</span>
<span class="n">eval_cfg</span><span class="o">.</span><span class="n">to_eval</span><span class="o">.</span><span class="n">actual</span> <span class="o">=</span> <span class="s1">&#39;labels&#39;</span>
<span class="n">eval_cfg</span><span class="o">.</span><span class="n">to_eval</span><span class="o">.</span><span class="n">predicted</span> <span class="o">=</span> <span class="s1">&#39;polarity_label&#39;</span>
<span class="n">eval_cfg</span><span class="o">.</span><span class="n">to_eval</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;positive&#39;</span><span class="p">,</span><span class="s1">&#39;neutral&#39;</span><span class="p">,</span><span class="s1">&#39;negative&#39;</span><span class="p">]</span>
<span class="n">eval_cfg</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="s1">&#39;./data/predict&#39;</span>
<span class="n">eval_cfg</span><span class="o">.</span><span class="n">data_file</span> <span class="o">=</span> <span class="s1">&#39;financial_phrasebank-*.parquet&#39;</span>
<span class="n">eval_cfg</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">=</span> <span class="s1">&#39;./data/eval&#39;</span>
<span class="c1"># eval_cfg.method.average = None</span>
<span class="c1"># eKonf.print(eval_cfg)</span>
<span class="n">eKonf</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">eval_cfg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading 3 dataframes from [&#39;./data/predict/financial_phrasebank-train.parquet&#39;, &#39;./data/predict/financial_phrasebank-test.parquet&#39;, &#39;./data/predict/financial_phrasebank-dev.parquet&#39;]
Accuracy:  0.6418769366976538
Precison:  0.6332357082536276
Recall:  0.6418769366976538
F1 Score:  0.5976583790508804
Model Report: 
___________________________________________________
              precision    recall  f1-score   support

    negative       0.38      0.36      0.37       303
     neutral       0.68      0.89      0.77      1386
    positive       0.65      0.19      0.29       570

    accuracy                           0.64      2259
   macro avg       0.57      0.48      0.48      2259
weighted avg       0.63      0.64      0.60      2259
</pre></div>
</div>
<img alt="../../../_images/sentiment_10_1.png" src="../../../_images/sentiment_10_1.png" />
</div>
</div>
</div>
<div class="section" id="instantiating-a-transformer-classficiation-model-with-financial-phrasebank-dataset">
<h2>Instantiating a transformer classficiation model with <code class="docutils literal notranslate"><span class="pre">financial_phrasebank</span></code> dataset<a class="headerlink" href="#instantiating-a-transformer-classficiation-model-with-financial-phrasebank-dataset" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">overrides</span><span class="o">=</span><span class="p">[</span>
    <span class="s1">&#39;+model/transformer=simple_classification&#39;</span><span class="p">,</span>
    <span class="s1">&#39;+model/transformer/pretrained=finbert&#39;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">model_cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">overrides</span><span class="o">=</span><span class="n">overrides</span><span class="p">,</span> <span class="n">config_group</span><span class="o">=</span><span class="s1">&#39;model/transformer=simple_classification&#39;</span><span class="p">)</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">ds_cfg</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">num_train_epochs</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">max_seq_length</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">train_batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">eval_batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;positive&#39;</span><span class="p">,</span><span class="s1">&#39;neutral&#39;</span><span class="p">,</span><span class="s1">&#39;negative&#39;</span><span class="p">]</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">_call_</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span>
<span class="n">eKonf</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">model_cfg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "3352e1c1abfe4a0784b61675bde8fa4e"}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.8/site-packages/transformers/optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "238044a5dff84865a5fd3896640d6e6f"}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Failed to detect the name of this notebook, you can set it manually with the WANDB_NOTEBOOK_NAME environment variable to enable code saving.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>: Currently logged in as: <span class=" -Color -Color-Yellow">entelecheia</span>. Use <span class=" -Color -Color-Bold">`wandb login --relogin`</span> to force relogin
</pre></div>
</div>
<div class="output text_html">Tracking run with wandb version 0.12.16</div><div class="output text_html">Run data is saved locally in <code>/root/.ekorpkit/projects/default/outputs/default-model/finbert/wandb/run-20220509_004459-3evh3nik</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/default-model/runs/3evh3nik" target="_blank">icy-vortex-29</a></strong> to <a href="https://wandb.ai/entelecheia/default-model" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "d667437afb5747299899c6b93e7e7b38"}
</script><div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="nn">/opt/conda/lib/python3.8/site-packages/torch/serialization.py</span> in <span class="ni">save</span><span class="nt">(obj, f, pickle_module, pickle_protocol, _use_new_zipfile_serialization)</span>
<span class="g g-Whitespace">    </span><span class="mi">371</span>             <span class="k">with</span> <span class="n">_open_zipfile_writer</span><span class="p">(</span><span class="n">opened_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">opened_zipfile</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">372</span>                 <span class="n">_save</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">opened_zipfile</span><span class="p">,</span> <span class="n">pickle_module</span><span class="p">,</span> <span class="n">pickle_protocol</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">373</span>                 <span class="k">return</span>

<span class="nn">/opt/conda/lib/python3.8/site-packages/torch/serialization.py</span> in <span class="ni">_save</span><span class="nt">(obj, zip_file, pickle_module, pickle_protocol)</span>
<span class="g g-Whitespace">    </span><span class="mi">490</span>         <span class="n">num_bytes</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">*</span> <span class="n">storage</span><span class="o">.</span><span class="n">element_size</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">491</span>         <span class="n">zip_file</span><span class="o">.</span><span class="n">write_record</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">storage</span><span class="o">.</span><span class="n">data_ptr</span><span class="p">(),</span> <span class="n">num_bytes</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">492</span> 

<span class="ne">KeyboardInterrupt</span>: 

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">RuntimeError</span><span class="g g-Whitespace">                              </span>Traceback (most recent call last)
<span class="nn">/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py</span> in <span class="ni">_call_target</span><span class="nt">(_target_, _partial_, args, kwargs, full_key)</span>
<span class="g g-Whitespace">     </span><span class="mi">85</span>         <span class="k">try</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">86</span>             <span class="k">return</span> <span class="n">_target_</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">87</span>         <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>

<span class="nn">/workspace/projects/ekorpkit/ekorpkit/models/transformer/simple.py</span> in <span class="ni">__init__</span><span class="nt">(self, **args)</span>
<span class="g g-Whitespace">    </span><span class="mi">179</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">180</span>         <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">args</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">181</span> 

<span class="nn">/workspace/projects/ekorpkit/ekorpkit/models/transformer/simple.py</span> in <span class="ni">__init__</span><span class="nt">(self, **args)</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span> 
<span class="ne">---&gt; </span><span class="mi">43</span>         <span class="n">eKonf</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_call_</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">44</span> 

<span class="nn">/workspace/projects/ekorpkit/ekorpkit/ekonf.py</span> in <span class="ni">call</span><span class="nt">(cfg, obj)</span>
<span class="g g-Whitespace">    </span><span class="mi">558</span>     <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="n">cfg</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="nb">object</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">559</span>         <span class="n">_call</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">560</span> 

<span class="nn">/workspace/projects/ekorpkit/ekorpkit/ekonf.py</span> in <span class="ni">_call</span><span class="nt">(cfg, obj)</span>
<span class="g g-Whitespace">    </span><span class="mi">196</span>                 <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_run</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">197</span>                     <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">_run</span><span class="p">)()</span>
<span class="g g-Whitespace">    </span><span class="mi">198</span>                 <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_run</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>

<span class="nn">/workspace/projects/ekorpkit/ekorpkit/models/transformer/simple.py</span> in <span class="ni">train</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">203</span>         <span class="c1"># Train the model</span>
<span class="ne">--&gt; </span><span class="mi">204</span>         <span class="n">model</span><span class="o">.</span><span class="n">train_model</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">205</span>             <span class="bp">self</span><span class="o">.</span><span class="n">train_data</span><span class="p">,</span> <span class="n">eval_df</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eval_data</span><span class="p">,</span> <span class="n">acc</span><span class="o">=</span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span>

<span class="nn">/opt/conda/lib/python3.8/site-packages/simpletransformers/classification/classification_model.py</span> in <span class="ni">train_model</span><span class="nt">(self, train_df, multi_label, output_dir, show_running_loss, args, eval_df, verbose, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">604</span> 
<span class="ne">--&gt; </span><span class="mi">605</span>         <span class="n">global_step</span><span class="p">,</span> <span class="n">training_details</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">train</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">606</span>             <span class="n">train_dataloader</span><span class="p">,</span>

<span class="nn">/opt/conda/lib/python3.8/site-packages/simpletransformers/classification/classification_model.py</span> in <span class="ni">train</span><span class="nt">(self, train_dataloader, output_dir, multi_label, show_running_loss, eval_df, test_df, verbose, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1194</span>                     <span class="n">best_eval_metric</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">early_stopping_metric</span><span class="p">]</span>
<span class="ne">-&gt; </span><span class="mi">1195</span>                     <span class="bp">self</span><span class="o">.</span><span class="n">save_model</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1196</span>                         <span class="n">args</span><span class="o">.</span><span class="n">best_model_dir</span><span class="p">,</span>

<span class="nn">/opt/conda/lib/python3.8/site-packages/simpletransformers/classification/classification_model.py</span> in <span class="ni">save_model</span><span class="nt">(self, output_dir, optimizer, scheduler, model, results)</span>
<span class="g g-Whitespace">   </span><span class="mi">2406</span>             <span class="k">if</span> <span class="n">optimizer</span> <span class="ow">and</span> <span class="n">scheduler</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">save_optimizer_and_scheduler</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2407</span>                 <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2408</span>                     <span class="n">optimizer</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;optimizer.pt&quot;</span><span class="p">)</span>

<span class="nn">/opt/conda/lib/python3.8/site-packages/torch/serialization.py</span> in <span class="ni">save</span><span class="nt">(obj, f, pickle_module, pickle_protocol, _use_new_zipfile_serialization)</span>
<span class="g g-Whitespace">    </span><span class="mi">372</span>                 <span class="n">_save</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">opened_zipfile</span><span class="p">,</span> <span class="n">pickle_module</span><span class="p">,</span> <span class="n">pickle_protocol</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">373</span>                 <span class="k">return</span>
<span class="g g-Whitespace">    </span><span class="mi">374</span>         <span class="n">_legacy_save</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">opened_file</span><span class="p">,</span> <span class="n">pickle_module</span><span class="p">,</span> <span class="n">pickle_protocol</span><span class="p">)</span>

<span class="nn">/opt/conda/lib/python3.8/site-packages/torch/serialization.py</span> in <span class="ni">__exit__</span><span class="nt">(self, *args)</span>
<span class="g g-Whitespace">    </span><span class="mi">258</span>     <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">259</span>         <span class="bp">self</span><span class="o">.</span><span class="n">file_like</span><span class="o">.</span><span class="n">write_end_of_file</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span>         <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

<span class="ne">RuntimeError</span>: [enforce fail at inline_container.cc:287] . unexpected pos 363786368 vs 363786256

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">InstantiationException</span><span class="g g-Whitespace">                    </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">7</span><span class="o">-</span><span class="mi">726836300</span><span class="n">d56</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> <span class="n">model_cfg</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;positive&#39;</span><span class="p">,</span><span class="s1">&#39;neutral&#39;</span><span class="p">,</span><span class="s1">&#39;negative&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="n">model_cfg</span><span class="o">.</span><span class="n">_call_</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span>
<span class="ne">---&gt; </span><span class="mi">14</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">model_cfg</span><span class="p">)</span>

<span class="nn">/workspace/projects/ekorpkit/ekorpkit/ekonf.py</span> in <span class="ni">instantiate</span><span class="nt">(config, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">507</span>     <span class="nd">@staticmethod</span>
<span class="g g-Whitespace">    </span><span class="mi">508</span>     <span class="k">def</span> <span class="nf">instantiate</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">509</span>         <span class="k">return</span> <span class="n">_instantiate</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">510</span> 
<span class="g g-Whitespace">    </span><span class="mi">511</span>     <span class="nd">@staticmethod</span>

<span class="nn">/workspace/projects/ekorpkit/ekorpkit/ekonf.py</span> in <span class="ni">_instantiate</span><span class="nt">(config, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">343</span>     <span class="k">if</span> <span class="n">_Keys</span><span class="o">.</span><span class="n">RECURSIVE</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">344</span>         <span class="n">kwargs</span><span class="p">[</span><span class="n">_Keys</span><span class="o">.</span><span class="n">RECURSIVE</span><span class="p">]</span> <span class="o">=</span> <span class="n">_recursive_</span>
<span class="ne">--&gt; </span><span class="mi">345</span>     <span class="k">return</span> <span class="n">hydra</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">346</span> 
<span class="g g-Whitespace">    </span><span class="mi">347</span> 

<span class="nn">/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py</span> in <span class="ni">instantiate</span><span class="nt">(config, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">216</span>         <span class="n">_partial_</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">_Keys</span><span class="o">.</span><span class="n">PARTIAL</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">217</span> 
<span class="ne">--&gt; </span><span class="mi">218</span>         <span class="k">return</span> <span class="n">instantiate_node</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">219</span>             <span class="n">config</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="n">_recursive_</span><span class="p">,</span> <span class="n">convert</span><span class="o">=</span><span class="n">_convert_</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="n">_partial_</span>
<span class="g g-Whitespace">    </span><span class="mi">220</span>         <span class="p">)</span>

<span class="nn">/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py</span> in <span class="ni">instantiate_node</span><span class="nt">(node, convert, recursive, partial, *args)</span>
<span class="g g-Whitespace">    </span><span class="mi">329</span>                     <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">_convert_node</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">convert</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">330</span> 
<span class="ne">--&gt; </span><span class="mi">331</span>             <span class="k">return</span> <span class="n">_call_target</span><span class="p">(</span><span class="n">_target_</span><span class="p">,</span> <span class="n">partial</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">full_key</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">332</span>         <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">333</span>             <span class="c1"># If ALL or PARTIAL non structured, instantiate in dict and resolve interpolations eagerly.</span>

<span class="nn">/opt/conda/lib/python3.8/site-packages/hydra/_internal/instantiate/_instantiate2.py</span> in <span class="ni">_call_target</span><span class="nt">(_target_, _partial_, args, kwargs, full_key)</span>
<span class="g g-Whitespace">     </span><span class="mi">89</span>             <span class="k">if</span> <span class="n">full_key</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">90</span>                 <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">full_key: </span><span class="si">{</span><span class="n">full_key</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="ne">---&gt; </span><span class="mi">91</span>             <span class="k">raise</span> <span class="n">InstantiationException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
<span class="g g-Whitespace">     </span><span class="mi">92</span> 
<span class="g g-Whitespace">     </span><span class="mi">93</span> 

<span class="ne">InstantiationException</span>: Error in call to target &#39;ekorpkit.models.transformer.simple.SimpleClassification&#39;:
<span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;[enforce fail at inline_container.cc:287] . unexpected pos 363786368 vs 363786256&#39;</span><span class="p">)</span>
<span class="ne">full_key</span>: model.transformer
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">overrides</span><span class="o">=</span><span class="p">[</span>
    <span class="s1">&#39;+model/transformer=simple_classification&#39;</span><span class="p">,</span>
    <span class="s1">&#39;+model/transformer/pretrained=finbert&#39;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">model_cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">overrides</span><span class="o">=</span><span class="n">overrides</span><span class="p">,</span> <span class="n">config_group</span><span class="o">=</span><span class="s1">&#39;model/transformer=simple_classification&#39;</span><span class="p">)</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">ds_cfg</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">num_train_epochs</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">max_seq_length</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">train_batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">eval_batch_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;positive&#39;</span><span class="p">,</span><span class="s1">&#39;neutral&#39;</span><span class="p">,</span><span class="s1">&#39;negative&#39;</span><span class="p">]</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">_call_</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;eval&#39;</span><span class="p">]</span>
<span class="n">eKonf</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">model_cfg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "596ef1ab7ee64964a457a9d9215fefde", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "0b5cc1d3611e44899babbf2e22931b0c", "version_major": 2, "version_minor": 0}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy:  0.8230088495575221
Precison:  0.858906145289853
Recall:  0.8230088495575221
F1 Score:  0.8058759358010397
Model Report: 
___________________________________________________
              precision    recall  f1-score   support

    negative       1.00      0.25      0.39        61
     neutral       0.93      0.95      0.94       277
    positive       0.61      0.83      0.71       114

    accuracy                           0.82       452
   macro avg       0.85      0.68      0.68       452
weighted avg       0.86      0.82      0.81       452
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ekorpkit.models.transformer.simple.SimpleClassification at 0x7f2170cf1250&gt;
</pre></div>
</div>
<img alt="../../../_images/sentiment_13_4.png" src="../../../_images/sentiment_13_4.png" />
</div>
</div>
</div>
<div class="section" id="instantiating-a-t5-classficiation-model-with-financial-phrasebank-dataset">
<h2>Instantiating a T5 classficiation model with <code class="docutils literal notranslate"><span class="pre">financial_phrasebank</span></code> dataset<a class="headerlink" href="#instantiating-a-t5-classficiation-model-with-financial-phrasebank-dataset" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">overrides</span><span class="o">=</span><span class="p">[</span>
    <span class="s1">&#39;+model/transformer=simple_t5_classification&#39;</span><span class="p">,</span>
    <span class="s1">&#39;+model/transformer/pretrained=t5-base&#39;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">model_cfg</span> <span class="o">=</span> <span class="n">eKonf</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">overrides</span><span class="o">=</span><span class="n">overrides</span><span class="p">,</span> <span class="n">config_group</span><span class="o">=</span><span class="s1">&#39;model/transformer=simple_t5_classification&#39;</span><span class="p">)</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">ds_cfg</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">num_train_epochs</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">max_seq_length</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">train_batch_size</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">eval_batch_size</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;positive&#39;</span><span class="p">,</span><span class="s1">&#39;neutral&#39;</span><span class="p">,</span><span class="s1">&#39;negative&#39;</span><span class="p">]</span>
<span class="n">model_cfg</span><span class="o">.</span><span class="n">_call_</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;eval&#39;</span><span class="p">]</span>
<span class="n">eKonf</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="n">model_cfg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "c27071661fd0477e833e6c0766528de9", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "6db8d8627eef4cff97b8f0f609537ad9", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "dceeb23cf11e4cc99a5bb99973f52ad7", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "cd4b6454bea94019b588a0c540ce5209", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "179e2dc0dc904500ae903a1b1a45c28d", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Finishing last run (ID:1ul16vuo) before initializing another...</div><div class="output text_html">Waiting for W&B process to finish... <strong style="color:green">(success).</strong></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "cbbec2832a9749b5967ee57672cf4c18", "version_major": 2, "version_minor": 0}
</script><div class="output text_html">Synced <strong style="color:#cdcd00">galactic-force-16</strong>: <a href="https://wandb.ai/entelecheia/default-model/runs/1ul16vuo" target="_blank">https://wandb.ai/entelecheia/default-model/runs/1ul16vuo</a><br/>Synced 5 W&B file(s), 1 media file(s), 1 artifact file(s) and 0 other file(s)</div><div class="output text_html">Find logs at: <code>/root/.ekorpkit/projects/default/outputs/default-model/finbert/wandb/run-20220505_100228-1ul16vuo/logs</code></div><div class="output text_html">Successfully finished last run (ID:1ul16vuo). Initializing new run:<br/></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
</pre></div>
</div>
<div class="output text_html">Tracking run with wandb version 0.12.16</div><div class="output text_html">Run data is saved locally in <code>/root/.ekorpkit/projects/default/outputs/default-model/t5-base/wandb/run-20220505_100444-lre7gsjy</code></div><div class="output text_html">Syncing run <strong><a href="https://wandb.ai/entelecheia/default-model/runs/lre7gsjy" target="_blank">clone-council-17</a></strong> to <a href="https://wandb.ai/entelecheia/default-model" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/></div><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "655c7476dfa047978cd25cd1a7fb5dce", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "b4923b32c61b4a718cd40747e476bc15", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "0ffd1c5dce4b44f9b2d333f95ff3ca2e", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "6731fb6d35a14f489de3cf8c64ac36c9", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "5dbf262641004b1a9ecd099862e7521a", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "1f41755e7e40400bbf6bddd00c3e2774", "version_major": 2, "version_minor": 0}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;eval_loss&#39;: 0.06524399673199105}
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "0885cbe16c7a4d26a506757b77dce53d", "version_major": 2, "version_minor": 0}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy:  0.9734513274336283
Precison:  0.9741327574769587
Recall:  0.9734513274336283
F1 Score:  0.9734779147330259
Model Report: 
___________________________________________________
              precision    recall  f1-score   support

    negative       0.98      0.92      0.95        61
     neutral       0.99      0.98      0.99       277
    positive       0.93      0.98      0.96       114

    accuracy                           0.97       452
   macro avg       0.97      0.96      0.96       452
weighted avg       0.97      0.97      0.97       452
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ekorpkit.models.transformer.simple_t5.SimpleT5 at 0x7f217076e710&gt;
</pre></div>
</div>
<img alt="../../../_images/sentiment_15_25.png" src="../../../_images/sentiment_15_25.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./docs/tutorials/sentiment"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="predict_edgar.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Prediciting Sentiments</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../preprocessors/preprocessor.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Preprocessors</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By entelecheia<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>